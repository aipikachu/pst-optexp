\documentclass{scrartcl}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[ngerman]{babel}
\usepackage{lmodern}
\usepackage{pst-optexp}
\usepackage{showexpl}
\begin{document}
\lstset{explpreset={%
    escapeinside={*}{*}, pos=l,width=-99pt,overhang=0pt,hsep=5mm,
    varwidth,vsep=\bigskipamount,rframe={}}, }

Czerny-Turner monochromator
\begin{pspicture}[showgrid=true](0,-1)(10,5)
\psset{linewidth=1.5\pslinewidth}
\psframe[fillstyle=solid,fillcolor=gray!80,linestyle=none](0,-1)(9,4)
\psset{linecolor=white}\addtopsstyle{Beam}{linecolor=white}
\addtopsstyle{ExtendedMirror}{hatchcolor=white}
\pnode(0,3){A}\pnode(8,3){B}\pnode(3,1.5){C}\pnode(8,0){D}\pnode(0,0){E}%
\psset{mirrorradius=13,  mirrorwidth=1.5, gratingwidth=1.5, mirrortype=extended, phwidth=0.07, outerheight=1.5}%
\pinhole[position=0.2](A)(B)%
\mirror(A)(B)(C)
\optgrating[reverse, angle=15](B)(C)(D)
\mirror(C)(D)(E)
\pinhole[position=0.8](D)(E)
\drawwidebeam[beamwidth=0.2, beamdiv=0.1 8 0.2 mul atan neg]{(A)}{1-3}
\drawwidebeam[beamwidth=0.68, addtoBeam={linecolor=green!40!white}]{3-6}{(E)}
\drawwidebeam[beamangle=3, beamwidth=0.7, addtoBeam={linecolor=blue!40!white}]{3-6}
\drawwidebeam[beamangle=-3, beamwidth=0.65, addtoBeam={linecolor=red!40!white}]{3-6}
%\custombeam{%
%  \drawwidebeam[beamwidth=0.2, beamdiv=0.1 8 0.2 mul atan neg]{(A)}{2}
%  \drawwidebeam{2-4}
%  \drawwidebeam[beamdiv=0.1 8 0.2 mul atan neg]{4}{(E)}
%}
\end{pspicture}

\begin{LTXexample}[explpreset={escapeinside={}}]
\begin{pspicture*}(0,2)(3.05,6)
  \lens[lens=8 8 8, abspos=0.6](0.5,2)(3,2)
  \optplate[position=1, plateheight=6](0.5,2)(3,2)
  \psset{beampos=2.1}
  \drawbeam[beamangle=-60]{1}{2}
  \drawbeam[beamangle=-40]{1}{2}
  \drawbeam[beamangle=-20]{1}{2}
  \psline[linecolor=gray!50, linewidth=3\pslinewidth, arrows=->, arrowinset=0, arrowscale=1.3](\oenodeOut{1})([offset=2.1]\oenodeOut{1})
\end{pspicture*}
\end{LTXexample}

\begin{pspicture}[showgrid=true](0,-0.5)(12,2.5)
\psset{couplersize=0.5, couplertype=rectangular, couplersep=0.2}
\wdmsplitter(0, 1)(3,2)(3,0)
\psdot(\oenodeIfc{1}{})\uput[180](\oenodeIfc{1}{}){1}
\psdot(\oenodeIfc{2}{})\uput[0](\oenodeIfc{2}{}){2}
\psdot(\oenodeIfc{N}{})\uput[0](\oenodeIfc{N}{}){N}
\wdmcoupler(4, 2)(4,0)(7,1)
\psdot(\oenodeIfc{1}{})\uput[180](\oenodeIfc{1}{}){1}
\psdot(\oenodeIfc{2}{})\uput[180](\oenodeIfc{2}{}){2}
\psdot(\oenodeIfc{N}{})\uput[0](\oenodeIfc{N}{}){N}
\optcoupler(8,2)(8,0)(11,2)(11,0)
\psdot(\oenodeIfc{1}{})\uput[180](\oenodeIfc{1}{}){1}
\psdot(\oenodeIfc{2}{})\uput[180](\oenodeIfc{2}{}){2}
\psdot(\oenodeIfc{3}{})\uput[0](\oenodeIfc{3}{}){3}
\psdot(\oenodeIfc{N}{})\uput[0](\oenodeIfc{N}{}){N}
\end{pspicture}
\newpsobject{MOLensIn}{lens}{lens=0.5 0.5 0.5}
\newpsobject{MOLensOut}{lens}{lens=4 4 2}
\begin{pspicture}[showgrid=true](5,2) 
   \pnode(0,1){A}\pnode(5,1){B}
   \psset{n=1}
   \begin{optexp}
   \MOLensIn[abspos=0.5](A)(B){}
   \MOLensOut[abspos=1](A)(B){}
   \MOLensOut[abspos=4](A)(B){}
   \MOLensIn[abspos=4.5](A)(B){}
   \addtopsstyle{Beam}{fillstyle=solid, fillcolor=red, opacity=0.3}
  \custombeam{%
    \drawwidebeam[beamwidth=0.2]{(A)}{1}
    \drawwidebeam[beamdiv=45]{1}{2}
    \drawwidebeam[stopinside]{2}{3}
    \drawwidebeam[beamdiv=-45]{3}{4}
    \drawwidebeam{4}{(B)}
  }%
 \end{optexp}
\end{pspicture}

\begin{pspicture}(3,2) 
  \pnode(0,1){A}\pnode(3,1){B}
  \begin{optexp}
  \lens[lens=0.5 0.5 0.5, abspos=0.5](A)(B)
  \lens[lens=4 4 2, abspos=1.5](A)(B)
  \addtopsstyle{Beam}{fillstyle=solid, fillcolor=green, opacity=0.3}
  \custombeam{%
    \drawwidebeam[beamwidth=0.2, stopinside]{(A)}{1}
    \drawwidebeam[beamdiv=-35]{1}{2}
    \drawwidebeam{2}{(B)}
  }%
  \end{optexp}
\end{pspicture}

\begin{pspicture*}(0,1.5)(7,5)
\lens[lens=6 6 6, n=2](0,2)(6,2)
\optplate[plateheight=4](3,2)(10,2)
\addtopsstyle{Beam}{linewidth=0.5\pslinewidth}
\multido{\r=-0.25+0.25}{3}{%
  \drawbeam[beamangle=0, beampos=\r]{(0,2)}{1}{2}
}%
\multido{\r=-0.25+0.25}{3}{%
  \drawbeam[linecolor=red, beamangle=15, beampos=\r]{(0,2)}{1}{2}
}%
\multido{\r=-0.25+0.25}{3}{%
  \drawbeam[linecolor=blue, beamangle=30, beampos=\r]{(0,2)}{1}{2}
}%
\end{pspicture*}

\begin{pspicture*}(0,1.5)(7,5)
\lens[lens=6 6 6, n=2](0,2)(6,2)
\optplate[plateheight=4](3,2)(10,2)
\addtopsstyle{Beam}{linewidth=0.5\pslinewidth}
\multido{\r=-0.15+0.3}{2}{%
  \drawbeam[beampos=\r]{(0,2)}{1}{2}
}%
\multido{\r=0.5+0.3}{2}{%
  \drawbeam[linecolor=red, beampos=\r]{(0,2)}{1}{2}
}%
\multido{\r=1.15+0.3}{2}{%
  \drawbeam[linecolor=blue, beampos=\r]{(0,2)}{1}{2}
}%
\end{pspicture*}

\begin{pspicture}[showgrid=true](5,3)
  \lens[n=2.0, lens=3 3 3](0,1)(5,1)
  \optplane(0,1)(0,1){AA}
  \drawbeam[beampos=0.5]{AA}{1}{(5,2)}
\end{pspicture}
\end{document}
